---
import templates from "../../data/templates.json";
// Props: title?: string; count?: number
const { title = '関連テンプレート', count = 2 } = Astro.props;
function withUtm(u){ try{ const url=new URL(u); url.searchParams.set('utm_source','bochi-it-note'); url.searchParams.set('utm_medium','crosssell'); url.searchParams.set('utm_campaign','templates'); return url.toString(); }catch(e){ return u; } }
const picks = templates.slice(0, Math.max(0, Math.min(count, templates.length)));
---

{picks.length > 0 && (
	<section class="mt-10 rounded-md border border-gray-200 bg-white p-4">
		<h2 class="text-sm font-semibold text-gray-900">{title}</h2>
		<ul class="mt-3 grid gap-3 sm:grid-cols-2">
			{picks.map(t => (
				<li class="rounded-md border p-3">
					<p class="font-medium">{t.title}</p>
					<p class="mt-1 text-xs text-gray-600">¥{t.priceJPY.toLocaleString()}・{t.platform}</p>
					<a data-track="out_template" data-type="template" data-id={t.slug} href={withUtm(t.url)} target="_blank" rel="nofollow noopener sponsored" class="mt-2 inline-block rounded bg-gray-900 px-3 py-2 text-sm text-white hover:bg-black">購入ページへ</a>
				</li>
			))}
		</ul>
	</section>
)}



