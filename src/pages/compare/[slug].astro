---
import BaseLayout from "../../layouts/BaseLayout.astro";
import products from "../../../data/products.json";
import comparisons from "../../../data/comparisons.json";
import freshness from "../../../data/freshness.json";
export function getStaticPaths() {
  return comparisons.map(c => ({ params: { slug: c.slug } }));
}
const { slug } = Astro.params;
const page = comparisons.find(c => c.slug === slug);
if (!page) {
  throw new Error(`Comparison not found: ${slug}`);
}
const a = products.find(p => p.slug === page.productA);
const b = products.find(p => p.slug === page.productB);
if (!a || !b) {
  throw new Error(`Products not found for comparison: ${slug}`);
}
const title = `${a.name} vs ${b.name}｜要件適合比較`;
const description = `${a.name}と${b.name}をSSO/SCIM、IP制限、監査ログ、データ所在などで比較。`;
const fr = (freshness[a.slug]?.needsReview || freshness[b.slug]?.needsReview);
---

<BaseLayout {title} {description}>
	<script type="application/ld+json" is:inline>{JSON.stringify({
		"@context": "https://schema.org",
		"@type": "Article",
		"headline": `${a.name} vs ${b.name}`,
		"url": `https://bochi-it-note.com/compare/${page.slug}`,
		"about": [a.name, b.name],
		"dateModified": page.last_updated
	})}</script>
	<article class="prose prose-zinc max-w-none">
		<h1>{a.name} vs {b.name}</h1>
		<p>{page.summary}</p>
		{fr && <p class="mt-2 inline-flex items-center rounded bg-yellow-100 px-2 py-1 text-xs text-yellow-800">要確認: 出典の変更が検知されました</p>}
		<table>
			<thead>
				<tr>
					<th>項目</th>
					<th>{a.name}</th>
					<th>{b.name}</th>
				</tr>
			</thead>
			<tbody>
				<tr><td>SSO</td><td>{a.features.sso ? '対応' : '未対応'}</td><td>{b.features.sso ? '対応' : '未対応'}</td></tr>
				<tr><td>SCIM</td><td>{a.features.scim ? '対応' : '未対応'}</td><td>{b.features.scim ? '対応' : '未対応'}</td></tr>
				<tr><td>IP制限</td><td>{a.features.ipAllowlist ? '対応' : '未対応'}</td><td>{b.features.ipAllowlist ? '対応' : '未対応'}</td></tr>
				<tr><td>監査ログ</td><td>{a.features.auditLog}</td><td>{b.features.auditLog}</td></tr>
				<tr><td>データ所在</td><td>{a.features.dataResidency}</td><td>{b.features.dataResidency}</td></tr>
			</tbody>
		</table>
		<h3>出典</h3>
		<ul>
			{a.sources.map(s => <li><a href={s.url} target="_blank" rel="noopener">{a.name}: {s.title}</a></li>)}
			{b.sources.map(s => <li><a href={s.url} target="_blank" rel="noopener">{b.name}: {s.title}</a></li>)}
		</ul>
	</article>
	<section class="mt-10">
		<h2 class="text-lg font-semibold">関連製品</h2>
		<ul class="mt-3 grid gap-3 sm:grid-cols-2">
			<li class="rounded-md border p-4">
				<a href={`/products/${a.slug}`} class="font-semibold hover:underline">{a.name}</a>
				<p class="mt-1 text-sm text-gray-600">SSO: {a.features.sso ? '対応' : '未対応'} / SCIM: {a.features.scim ? '対応' : '未対応'}</p>
			</li>
			<li class="rounded-md border p-4">
				<a href={`/products/${b.slug}`} class="font-semibold hover:underline">{b.name}</a>
				<p class="mt-1 text-sm text-gray-600">SSO: {b.features.sso ? '対応' : '未対応'} / SCIM: {b.features.scim ? '対応' : '未対応'}</p>
			</li>
		</ul>
	</section>
	<div class="mt-8">
		<a href="/compare/" class="text-sm underline">比較一覧に戻る</a>
	</div>
</BaseLayout>


