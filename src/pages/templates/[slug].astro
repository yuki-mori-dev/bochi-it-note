---
import BaseLayout from "../../layouts/BaseLayout.astro";
import templates from "../../../data/templates.json";
function withUtm(u){ try{ const url=new URL(u); url.searchParams.set('utm_source','bochi-it-note'); url.searchParams.set('utm_medium','template-detail'); url.searchParams.set('utm_campaign','templates'); return url.toString(); }catch(e){ return u; } }
export function getStaticPaths(){ return templates.map(t=>({ params: { slug: t.slug } })); }
const { slug } = Astro.params;
const t = templates.find(x=>x.slug===slug);
if(!t) throw new Error(`Template not found: ${slug}`);
const title = `${t.title}｜テンプレート詳細`;
const description = t.description;
---

<BaseLayout {title} {description}>
	<script type="application/ld+json" is:inline>{JSON.stringify({
		"@context":"https://schema.org",
		"@type":"CreativeWork",
		"name": t.title,
		"description": t.description,
		"url": `https://bochi-it-note.com/templates/${t.slug}`,
		"offers": {"@type":"Offer","price": String(t.priceJPY), "priceCurrency":"JPY"}
	})}</script>
	<div class="grid gap-6 lg:grid-cols-[1fr,280px]">
	<article class="prose prose-zinc max-w-none">
		<h1>{t.title}</h1>
		<p class="text-sm text-gray-600">最終更新: {t.last_updated}</p>
		<p>{t.description}</p>
		<ul>
			{t.includes?.map(i => <li>{i}</li>)}
		</ul>
		<p class="text-gray-900">価格: ¥{t.priceJPY.toLocaleString()}（{t.platform}）</p>
		<p class="mt-3">
			<a data-track="out_template" data-type="template" data-id={t.slug} href={withUtm(t.url)} target="_blank" rel="nofollow noopener sponsored" class="inline-flex items-center gap-1 rounded-md bg-gray-900 px-4 py-2 text-sm text-white hover:bg-black">購入ページへ</a>
		</p>
	</article>
	<aside class="self-start rounded-md border border-gray-200 bg-white p-4 lg:sticky lg:top-6">
		<p class="text-sm font-semibold text-gray-900">今すぐ入手</p>
		<p class="mt-1 text-xs text-gray-600">稟議/RFPの作成時間を短縮</p>
		<a data-track="out_template" data-type="template" data-id={t.slug} href={withUtm(t.url)} target="_blank" rel="nofollow noopener sponsored" class="mt-3 inline-block w-full rounded-md bg-gray-900 px-4 py-2 text-center text-sm text-white hover:bg-black">購入ページへ</a>
	</aside>
	</div>
	<section class="mt-10">
		<h2 class="text-lg font-semibold">他のテンプレ</h2>
		<ul class="mt-3 grid gap-3 sm:grid-cols-2">
			{templates.filter(x=>x.slug!==t.slug).slice(0,4).map(x => (
				<li class="rounded-md border p-4">
					<a class="font-semibold hover:underline" href={`/templates/${x.slug}`}>{x.title}</a>
					<p class="mt-1 text-sm text-gray-600">¥{x.priceJPY.toLocaleString()}・{x.platform}</p>
				</li>
			))}
		</ul>
	</section>
</BaseLayout>



